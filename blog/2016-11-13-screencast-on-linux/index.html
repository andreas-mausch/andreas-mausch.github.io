
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Eleventy v3.0.0">
    <title>Record Screencasts on Linux</title>
    <link rel="stylesheet" href="/styles/style.css"/>
    <link rel="stylesheet" href="/styles/icons/iconism.css"/>
    
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" sizes="any"/>
  </head>
  <body>
    <header class="site-header">
      <div class="site-header-content">
        <a class="site-title" href="/">Andreas Mausch</a>
        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              version="1.1"
              viewbox="0 0 16 16"
              width="100%"
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5">
              <path d="m2.75 12.25h10.5m-10.5-4h10.5m-10.5-4h10.5"/>
            </svg>
          </a>
          <input id="nav-toggle" type="checkbox"/>
          <label class="nav-button-container" for="nav-toggle">
            <div class="nav-button"></div>
          </label>
          <ol class="site-nav-items">
            <a class="page-link" href="/"><li class="page-link-home">Home</li></a><a class="page-link" href="/whatsapp-viewer/"><li>WhatsApp Viewer</li></a><a class="page-link" href="/blog/"><li>Blog</li></a></ol>
        </nav>
      </div>
    </header>
    <div class="content">
      
<h1>Record Screencasts on Linux</h1>
<div>
  <time class="postlist-date" datetime="2016-11-12T17:00:00.000+00:00">Nov 12, 2016</time>
  <ul class="tags">
    
        
          <li><a href="/blog/tags/ffmpeg">#ffmpeg</a></li>
        
    
        
    
        
          <li><a href="/blog/tags/recording">#recording</a></li>
        
    
        
          <li><a href="/blog/tags/screencast">#screencast</a></li>
        
    
  </ul>
</div>



<h1 id="useful-ffmpeg-commands-for-recording-your-screen" tabindex="-1">1. Useful FFMPEG commands for recording your screen <a class="header-anchor" href="#useful-ffmpeg-commands-for-recording-your-screen" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token comment"># Record screen without audio. Replace 3840x2160 with your resolution.</span></span>
<span class="highlight-line"><span class="token comment"># The video is lossless, because of the -qp 0 flag.</span></span>
<span class="highlight-line">ffmpeg <span class="token parameter variable">-video_size</span> 3840x2160 <span class="token parameter variable">-framerate</span> <span class="token number">30</span> <span class="token parameter variable">-f</span> x11grab <span class="token parameter variable">-i</span> :0.0 <span class="token parameter variable">-c:v</span> libx264rgb <span class="token parameter variable">-qp</span> <span class="token number">0</span> <span class="token parameter variable">-preset</span> ultrafast capture.mp4</span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment"># Record screen without audio, downscaled to 1920x1080</span></span>
<span class="highlight-line">ffmpeg <span class="token parameter variable">-video_size</span> 3840x2160 <span class="token parameter variable">-framerate</span> <span class="token number">30</span> <span class="token parameter variable">-f</span> x11grab <span class="token parameter variable">-i</span> :0.0 <span class="token parameter variable">-vf</span> <span class="token assign-left variable">scale</span><span class="token operator">=</span><span class="token number">1920</span>:1080 <span class="token parameter variable">-c:v</span> libx264rgb <span class="token parameter variable">-qp</span> <span class="token number">0</span> <span class="token parameter variable">-preset</span> ultrafast capture.mp4</span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment"># Record screen with the audio you hear, but without microphone.</span></span>
<span class="highlight-line"><span class="token comment"># Use "pacmd list-sources" to find your device name, see below.</span></span>
<span class="highlight-line">ffmpeg <span class="token parameter variable">-f</span> pulse <span class="token parameter variable">-i</span> alsa_output.pci-0000_00_1f.3.analog-stereo.monitor <span class="token parameter variable">-video_size</span> 3840x2160 <span class="token parameter variable">-framerate</span> <span class="token number">30</span> <span class="token parameter variable">-f</span> x11grab <span class="token parameter variable">-i</span> :0.0 <span class="token parameter variable">-c:v</span> libx264rgb <span class="token parameter variable">-qp</span> <span class="token number">0</span> <span class="token parameter variable">-preset</span> ultrafast capture.mp4</span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token comment"># Record screen with both, speakers and microphone audio.</span></span>
<span class="highlight-line">ffmpeg <span class="token parameter variable">-f</span> pulse <span class="token parameter variable">-ac</span> <span class="token number">2</span> <span class="token parameter variable">-i</span> alsa_output.pci-0000_00_1f.3.analog-stereo.monitor <span class="token parameter variable">-f</span> pulse <span class="token parameter variable">-ac</span> <span class="token number">1</span> <span class="token parameter variable">-i</span> alsa_input.pci-0000_00_1f.3.analog-stereo <span class="token parameter variable">-filter_complex</span> <span class="token assign-left variable">amix</span><span class="token operator">=</span>inputs<span class="token operator">=</span><span class="token number">2</span> <span class="token parameter variable">-video_size</span> 3840x2160 <span class="token parameter variable">-framerate</span> <span class="token number">30</span> <span class="token parameter variable">-f</span> x11grab <span class="token parameter variable">-i</span> :0.0 <span class="token parameter variable">-c:v</span> libx264rgb <span class="token parameter variable">-qp</span> <span class="token number">0</span> <span class="token parameter variable">-preset</span> ultrafast capture.mp4</span></code></pre>

    </div><h1 id="description" tabindex="-1">2. Description <a class="header-anchor" href="#description" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>Hi, I tried to record a screencast on Linux.</p>
<p>There are good working tools already out there, a very easy one to use is Kazam.</p>
<p>However, I was looking for a tool which can downscale the video, while still recording the speakers audio and my microphone.</p>
<p>So, Kazam is easy to use but you can't configure much. It has no option to downscale the video.</p>
<p>SimpleScreenRecorder offers way more options, especially for encoding, but it is not easy to record speakers and microphone.</p>
<p>I ended up using ffmpeg, a user-unfriendly command line tool. It worked, but audio was very low volume. Please see below for the audio fix.</p>
<h1 id="fixing-the-colors" tabindex="-1">3. Fixing the colors <a class="header-anchor" href="#fixing-the-colors" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>While SimpleScreenRecorder recorded the colors of the screen as they were, I had slightly shifted colors in ffmpeg and Kazam. I was able to fix it for ffmpeg by using libx264rgb instead of libx264. See the screenshot below, top is wrong colors, bottom is correct colors:</p>
<div class="image-comparison-slider"><img-comparison-slider><img slot="first" src="/blog/2016-11-13-screencast-on-linux/before.png" width="569" height="138" style="max-height: 80vh" /><img slot="second" src="/blog/2016-11-13-screencast-on-linux/after.png"  width="569" height="138" style="max-height: 80vh" /><svg slot="handle" class="image-comparison-slider-handle" xmlns="http://www.w3.org/2000/svg" width="125" viewBox="-8 -3 16 6"><path stroke="#777" d="M -5 -2 L -7 0 L -5 2 M -5 -2 L -5 2 M 5 -2 L 7 0 L 5 2 M 5 -2 L 5 2" stroke-width="1" fill="currentColor" vector-effect="non-scaling-stroke"></path></svg></img-comparison-slider></div>
<h1 id="fixing-the-audio" tabindex="-1">4. Fixing the audio <a class="header-anchor" href="#fixing-the-audio" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>I figured out the volume of my PulseAudio device was set to 20% for whatever reason.</p>
<p>So first, list all your PulseAudio devices:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line">pacmd list-sources</span>
<span class="highlight-line"><span class="token comment"># To get a shorter list use this:</span></span>
<span class="highlight-line">pacmd list-sources<span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'/index:/ {print $0}; /name:/ {print $0}; /device\.description/ {print $0}'</span></span></code></pre>

    </div><p>On my PC, the output looks like this:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line">index: <span class="token number">0</span></span>
<span class="highlight-line">name: <span class="token operator">&lt;</span>alsa_output.pci-0000_00_1f.3.analog-stereo.monitor<span class="token operator">></span></span>
<span class="highlight-line">device.description <span class="token operator">=</span> <span class="token string">"Monitor of Internes Audio Analog Stereo"</span></span>
<span class="highlight-line">* index: <span class="token number">1</span></span>
<span class="highlight-line">name: <span class="token operator">&lt;</span>alsa_input.pci-0000_00_1f.3.analog-stereo<span class="token operator">></span></span>
<span class="highlight-line">device.description <span class="token operator">=</span> <span class="token string">"Internes Audio Analog Stereo"</span></span></code></pre>

    </div><p>The following command set the volume level to 100%, you can validate it by calling &quot;pacmd list-sources&quot; again.</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line">pactl set-source-volume <span class="token string">"alsa_output.pci-0000_00_1f.3.analog-stereo.monitor"</span> <span class="token number">100</span>%</span></code></pre>

    </div>

<script async src="/scripts/index.js"></script>

    </div>
  </body>
</html>
