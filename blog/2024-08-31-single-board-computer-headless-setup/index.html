
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Single-Board Computers: Headless Setup for Raspberry Pi, Orange Pi, Radax</title>
    <link rel="stylesheet" href="/styles/style.css"/>
    <link rel="stylesheet" href="/styles/icons/iconism.css"/>
    
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" sizes="any"/>
  </head>
  <body>
    <header class="site-header">
      <div class="site-header-content">
        <a class="site-title" href="/">Andreas Mausch</a>
        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              version="1.1"
              viewbox="0 0 16 16"
              width="100%"
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5">
              <path d="m2.75 12.25h10.5m-10.5-4h10.5m-10.5-4h10.5"/>
            </svg>
          </a>
          <input id="nav-toggle" type="checkbox"/>
          <label class="nav-button-container" for="nav-toggle">
            <div class="nav-button"></div>
          </label>
          <ol class="site-nav-items">
            <a class="page-link" href="/"><li class="page-link-home">Home</li></a><a class="page-link" href="/whatsapp-viewer/"><li>WhatsApp Viewer</li></a><a class="page-link" href="/blog/"><li>Blog</li></a></ol>
        </nav>
      </div>
    </header>
    <div class="content">
      
<h1>Single-Board Computers: Headless Setup for Raspberry Pi, Orange Pi, Radax</h1>
<div>
  <time class="postlist-date" datetime="2024-08-31T17:30:00.000+00:00">Aug 31, 2024</time>
  <ul class="tags">
    
        
          <li><a href="/blog/tags/armbian">#armbian</a></li>
        
    
        
          <li><a href="/blog/tags/orangepi">#orangepi</a></li>
        
    
        
    
        
          <li><a href="/blog/tags/radax">#radax</a></li>
        
    
        
          <li><a href="/blog/tags/rasbian">#rasbian</a></li>
        
    
        
          <li><a href="/blog/tags/raspberrypi">#raspberrypi</a></li>
        
    
  </ul>
</div>


  <aside>
    <nav class="toc">
                <ol>
                    
                    <li><a href="#raspberry-pi-os-%2F-rasbian">1. Raspberry Pi OS / Rasbian</a>
            
                <ol>
                    
                    <li><a href="#version-11-(bullseye)">1.1. Version 11 (bullseye)</a>
            
                <ol>
                    
                    <li><a href="#ssh">1.1.1. SSH</a>
            		</li>

                    <li><a href="#wifi">1.1.2. WiFi</a>
            		</li>

                    <li><a href="#hostname">1.1.3. Hostname</a>
            		</li>

                    <li><a href="#user">1.1.4. User</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#version-12-(bookworm)">1.2. Version 12 (bookworm)</a>
            
                <ol>
                    
                    <li><a href="#wtf%3F">1.2.1. WTF?</a>
            		</li>

                    <li><a href="#set-up-a-new-installation">1.2.2. Set up a new installation</a>
            		</li>

                    <li><a href="#other-files-than-firstrun.sh">1.2.3. Other files than firstrun.sh</a>
            		</li>
                </ol>
            		</li>
                </ol>
            		</li>

                    <li><a href="#armbian">2. Armbian</a>
            
                <ol>
                    
                    <li><a href="#hostname-1">2.1. Hostname</a>
            		</li>

                    <li><a href="#note-on-dhcp">2.2. Note on DHCP</a>
            		</li>

                    <li><a href="#why-in-%2Froot%2F-user-folder%3F">2.3. Why in /root/ user folder?</a>
            		</li>

                    <li><a href="#what-cost-me-time">2.4. What cost me time</a>
            		</li>
                </ol>
            		</li>
                </ol>
            </nav>
  </aside>


<p>I still like to set up my SPCs headless.
This way, I don't need to connect a monitor and keyboard.
I simply prepare the SD card on my laptop, plug it into the target and it connects to my network,
allowing me to SSH into it.</p>
<p>Since my <a href="/blog/2021-03-17-raspberry-pi-setup/">old post</a> is outdated,
here is an updated guide on how to set up an operating system for a single-board computer
like a Raspberry Pi, Orange Pi or Radax.</p>
<p>In all cases, it is assumed you have flashed the image to a sd card, like this:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line">xzcat ./2024-07-04-raspios-bookworm-armhf-lite.img.xz <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">dd</span> <span class="token assign-left variable">of</span><span class="token operator">=</span>/dev/mmcbzz0 <span class="token assign-left variable">bs</span><span class="token operator">=</span>1M <span class="token assign-left variable">oflag</span><span class="token operator">=</span>sync <span class="token assign-left variable">status</span><span class="token operator">=</span>progress</span></code></pre>

    </div><p>and the card is mounted into <code class="language-plain">/mnt/sdcard/</code>.</p>
<h1 id="raspberry-pi-os-%2F-rasbian" tabindex="-1">1. Raspberry Pi OS / Rasbian <a class="header-anchor" href="#raspberry-pi-os-%2F-rasbian" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>You can of course use the official <a href="https://github.com/raspberrypi/rpi-imager" class="external-link" target="_blank">rpi-imager</a>
or <a href="https://github.com/gitbls/sdm" class="external-link" target="_blank">sdm</a>, which both are great programs.</p>
<p>I prefer to do the setup manually though to see what changes on the filesystem.</p>
<h2 id="version-11-(bullseye)" tabindex="-1">1.1. Version 11 (bullseye) <a class="header-anchor" href="#version-11-(bullseye)" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>Tested with <code class="language-plain">2024-07-04-raspios-bullseye-armhf-lite.img.xz</code>.</p>
<h3 id="ssh" tabindex="-1">1.1.1. SSH <a class="header-anchor" href="#ssh" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">touch</span> /mnt/sdcard/bootfs/ssh</span></code></pre>

    </div><h3 id="wifi" tabindex="-1">1.1.2. WiFi <a class="header-anchor" href="#wifi" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>Create this file:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-plain"><code data-filename="/mnt/sdcard/bootfs/wpa_supplicant.conf" class="language-plain"><span class="highlight-line">country=US</span>
<span class="highlight-line">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev</span>
<span class="highlight-line">update_config=1</span>
<span class="highlight-line"></span>
<span class="highlight-line">network={</span>
<span class="highlight-line">    ssid="your_real_wifi_ssid"</span>
<span class="highlight-line">    psk="your_real_password"</span>
<span class="highlight-line">    key_mgmt=WPA-PSK</span>
<span class="highlight-line">}</span></code></pre>

    </div><p>Change your country, the SSID and the password (psk).</p>
<h3 id="hostname" tabindex="-1">1.1.3. Hostname <a class="header-anchor" href="#hostname" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>Edit the hostname in these files:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">sudo</span> <span class="token function">nano</span> /mnt/sdcard/rootfs/etc/hostname</span>
<span class="highlight-line"><span class="token function">sudo</span> <span class="token function">nano</span> /mnt/sdcard/rootfs/etc/hosts</span></code></pre>

    </div><h3 id="user" tabindex="-1">1.1.4. User <a class="header-anchor" href="#user" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-plain"><code data-filename="/mnt/sdcard/bootfs/userconf.txt" class="language-plain"><span class="highlight-line">myuser:$6$1TQy0EikzkV4Ukzy$ceXxUzbGmWPrPyJILfbtvm4j1crojHqd7UFSv0O3oXKM6QsyEandc5YLGJqDZsBeWKXcMI3KIpqTQ9Q3HWHG10</span></code></pre>

    </div><p>The password in this case is <code class="language-plain">mypassword</code>.</p>
<p>Generate your own via this command:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token builtin class-name">echo</span> <span class="token string">'mypassword'</span> <span class="token operator">|</span> openssl <span class="token function">passwd</span> <span class="token parameter variable">-6</span> <span class="token parameter variable">-stdin</span></span></code></pre>

    </div><h2 id="version-12-(bookworm)" tabindex="-1">1.2. Version 12 (bookworm) <a class="header-anchor" href="#version-12-(bookworm)" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<h3 id="wtf%3F" tabindex="-1">1.2.1. WTF? <a class="header-anchor" href="#wtf%3F" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>Things get a bit complicated here and on my first installation I
reluctantly went to use the official <a href="https://github.com/raspberrypi/rpi-imager" class="external-link" target="_blank">Raspberry Pi Imager</a>. :(</p>
<p>But now I finally found how to prepare the sd card without it by
<a href="https://zansara.substack.com/p/2024-01-06-raspberrypi-headless-bookworm-wifi-config" class="external-link" target="_blank">this great article</a>,
which reverse-engineered the Imager.</p>
<p>The imager sets up a <code class="language-plain">firstrun.sh</code> script and modifies the <code class="language-plain">cmdline.txt</code> to run it on first boot.
After that, the script deletes itself and removes itself also from <code class="language-plain">cmdline.txt</code> again.</p>
<p>The key program used is <a href="https://github.com/RPi-Distro/raspberrypi-sys-mods" class="external-link" target="_blank">raspberrypi-sys-mods</a>.</p>
<p>What I stumbled across during my reasearch, but things that were <strong>not</strong> useful for Raspberry Pi OS:</p>
<ul>
<li>cloud-init?
I guess it is only used by Ubuntu</li>
<li>netplan?
This one is used by Armbian actually, see below</li>
<li><code class="language-plain">custom.toml</code>
Didn't work for me.</li>
</ul>
<h3 id="set-up-a-new-installation" tabindex="-1">1.2.2. Set up a new installation <a class="header-anchor" href="#set-up-a-new-installation" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>I have copied the original <code class="language-plain">firstrun.sh</code> the imager created with my settings
and tried to generalize it, in order to only have a simple <code class="language-plain">firstrun.env</code> file,
which would be the only file to be changed for a new installation.</p>
<p>So here are my steps:</p>
<ol>
<li>Copy my modified <a href="/blog/2024-08-31-single-board-computer-headless-setup/raspberry-pi/bookworm/firstrun.sh">firstrun.sh</a> and <a href="/blog/2024-08-31-single-board-computer-headless-setup/raspberry-pi/bookworm/firstrun.env">firstrun.env</a> to <code class="language-plain">/mnt/sdcard/bootfs/</code>.</li>
<li>Make changes to <code class="language-plain">firstrun.env</code> to match your desired config.
Note: <code class="language-plain">MY_USER_PASSWORD</code> is optional.
I usually SSH via key into the machines and skip the password.</li>
<li>Modify <code class="language-plain">/mnt/sdcard/bootfs/cmdline.txt</code> and append this to the only long single line:
<code class="language-plain">cfg80211.ieee80211_regdom=DE systemd.run=/boot/firstrun.sh systemd.run_success_action=reboot systemd.unit=kernel-command-line.target</code><br>
This references the <code class="language-plain">firstrun.sh</code> to be run at first boot.</li>
<li>Change the region code in <code class="language-plain">cmdline.txt</code> to match your country.</li>
</ol>
<h3 id="other-files-than-firstrun.sh" tabindex="-1">1.2.3. Other files than firstrun.sh <a class="header-anchor" href="#other-files-than-firstrun.sh" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h3>
<p>My goal was to have a firstrun.env with all the related environment variables,
and only this files needs to be changed for future installations.
The <code class="language-plain">firstrun.sh</code> should remain untouched.</p>
<p>This was problematic, <a href="https://github.com/raspberrypi/rpi-imager/issues/554" class="external-link" target="_blank">because</a> there
is an <a href="https://github.com/RPi-Distro/raspberrypi-sys-mods/blob/a7d769745962126abd7c727e9a7d4238fe3fb2c2/initramfs-tools/scripts/local-bottom/imager_fixup" class="external-link" target="_blank">imager_fixup</a>
which makes changes to the file on the first boot.
What a hack, and it took me some hours to debug. :(</p>
<p>So what you could expect at <code class="language-plain">/boot/*</code> is in reality mounted during the boot process at <code class="language-plain">/boot/firmware/*</code>.</p>
<p>This whole setup process is a huge hack, and so much more complicated than before with bullseye.</p>
<h1 id="armbian" tabindex="-1">2. Armbian <a class="header-anchor" href="#armbian" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>Tested with Armbian 24.8.1:
Things are so much easier here.</p>
<p>Here is the setup:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">sudo</span> <span class="token function">cp</span> .not_logged_in_yet /mnt/sdcard/root/</span></code></pre>

    </div><p>The file should have existed there already, but should have been empty.</p>
<p>Download my example file: <a href="/blog/2024-08-31-single-board-computer-headless-setup/armbian/.not_logged_in_yet">.not_logged_in_yet</a></p>
<h2 id="hostname-1" tabindex="-1">2.1. Hostname <a class="header-anchor" href="#hostname-1" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>The file above does <strong>not</strong> cover the hostname.</p>
<p>Same as for bullseye:
Edit <code class="language-plain">/mnt/sdcard/etc/hosts</code> and <code class="language-plain">/mnt/sdcard/etc/hostname</code>.</p>
<h2 id="note-on-dhcp" tabindex="-1">2.2. Note on DHCP <a class="header-anchor" href="#note-on-dhcp" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>Important: You must set <code class="language-plain">PRESET_NET_USE_STATIC</code> to <code class="language-plain">0</code> explicitly.
If you skip this config entry, DHCP is not enabled.
See here:
<a href="https://github.com/armbian/build/blob/d16f710e7eabdfd9b1911aa6cc7648c25d038208/packages/bsp/common/usr/lib/armbian/armbian-firstlogin#L54" class="external-link" target="_blank">https://github.com/armbian/build/blob/d16f710e7eabdfd9b1911aa6cc7648c25d038208/packages/bsp/common/usr/lib/armbian/armbian-firstlogin#L54</a></p>
<h2 id="why-in-%2Froot%2F-user-folder%3F" tabindex="-1">2.3. Why in /root/ user folder? <a class="header-anchor" href="#why-in-%2Froot%2F-user-folder%3F" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>What's confusing to me:
I would have guessed that <code class="language-plain">/root/.not_logged_in_yet</code> is only executed after the first login via root.
That means WiFi settings would be obsolete here, because you could never login before the network connection is made.
However, some script somewhere writes a <code class="language-plain">/etc/netplan/*.yaml</code> file, if WiFi entries are found in <code class="language-plain">.not_logged_in_yet</code>.
Magic.</p>
<p>(Seems to happen around here
<a href="https://github.com/armbian/build/blob/d16f710e7eabdfd9b1911aa6cc7648c25d038208/packages/bsp/common/usr/lib/armbian/armbian-firstlogin#L119" class="external-link" target="_blank">https://github.com/armbian/build/blob/d16f710e7eabdfd9b1911aa6cc7648c25d038208/packages/bsp/common/usr/lib/armbian/armbian-firstlogin#L119</a>)</p>
<h2 id="what-cost-me-time" tabindex="-1">2.4. What cost me time <a class="header-anchor" href="#what-cost-me-time" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>All of this is not required:</p>
<ul>
<li><code class="language-plain">FR_net_wifi_ssid</code></li>
<li><code class="language-plain">armbian_first_run.txt</code></li>
<li>WiFi setup via <code class="language-plain">netplan</code>
This is still an alternative, but will be set up automatically via the <code class="language-plain">.not_logged_in_yet</code> file.</li>
</ul>


<script async src="/scripts/index.js"></script>

    </div>
  </body>
</html>
