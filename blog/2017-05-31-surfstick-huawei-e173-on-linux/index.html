
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Eleventy v3.0.0">
    <title>Surfstick Huawei E173 on Linux</title>
    <link rel="stylesheet" href="/styles/style.css"/>
    <link rel="stylesheet" href="/styles/icons/iconism.css"/>
    
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" sizes="any"/>
  </head>
  <body>
    <header class="site-header">
      <div class="site-header-content">
        <a class="site-title" href="/">Andreas Mausch</a>
        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              version="1.1"
              viewbox="0 0 16 16"
              width="100%"
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5">
              <path d="m2.75 12.25h10.5m-10.5-4h10.5m-10.5-4h10.5"/>
            </svg>
          </a>
          <input id="nav-toggle" type="checkbox"/>
          <label class="nav-button-container" for="nav-toggle">
            <div class="nav-button"></div>
          </label>
          <ol class="site-nav-items">
            <a class="page-link" href="/"><li class="page-link-home">Home</li></a><a class="page-link" href="/whatsapp-viewer/"><li>WhatsApp Viewer</li></a><a class="page-link" href="/blog/"><li>Blog</li></a></ol>
        </nav>
      </div>
    </header>
    <div class="content">
      
<h1>Surfstick Huawei E173 on Linux</h1>
<div>
  <time class="postlist-date" datetime="2017-05-31T17:00:00.000+00:00">May 31, 2017</time>
  <ul class="tags">
    
        
          <li><a href="/blog/tags/3g">#3g</a></li>
        
    
        
    
        
          <li><a href="/blog/tags/surfstick">#surfstick</a></li>
        
    
        
          <li><a href="/blog/tags/usb_modeswitch">#usb_modeswitch</a></li>
        
    
  </ul>
</div>



<p>I've tried to use an USB modem I've bought two years ago (and never really used) on my Linux machine.
On the first try, everything went plug'n'play and I was asked to enter the PIN and it automatically connected.
That was nice, but didn't work like that again. After some googling I've found this link:</p>
<p><a href="https://wiki.ubuntuusers.de/USB_ModeSwitch/" class="external-link" target="_blank">https://wiki.ubuntuusers.de/USB_ModeSwitch/</a><br>
(German only)</p>
<img src="/blog/2017-05-31-surfstick-huawei-e173-on-linux/huawei-lsusb-drive-mode.jpg" width="1565" height="900" alt="undefined">
<p>So &quot;Huawei Technologies Co., Ltd. Broadband stick&quot; is the device.<br>
We can see the Vendor ID (12d1) and the Product ID (1446).</p>
<p>A call to <code class="language-plain">usb-devices</code> shows it is in drive-mode:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-shell-session"><code class="language-shell-session"><span class="highlight-line"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">usb-devices</span></span></span>
<span class="highlight-line"><span class="token output">T:  Bus=01 Lev=01 Prnt=01 Port=00 Cnt=01 Dev#=  5 Spd=480 MxCh= 0</span>
<span class="highlight-line">D:  Ver= 2.00 Cls=00(>ifc ) Sub=00 Prot=00 MxPS=64 #Cfgs=  1</span>
<span class="highlight-line">P:  Vendor=12d1 ProdID=1446 Rev=00.00</span>
<span class="highlight-line">S:  Manufacturer=HUAWEI Technology</span>
<span class="highlight-line">S:  Product=HUAWEI Mobile</span>
<span class="highlight-line">C:  #Ifs= 2 Cfg#= 1 Atr=e0 MxPwr=500mA</span>
<span class="highlight-line">I:  If#= 0 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage</span>
<span class="highlight-line">I:  If#= 1 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage</span></code></pre>

    </div><p>The adjusted command from the wiki page (I've exchanged the Product ID):</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">sudo</span> usb_modeswitch <span class="token parameter variable">-v</span> 0x12d1 <span class="token parameter variable">-p</span> 0x1446 <span class="token parameter variable">-V</span> 0x12d1 <span class="token parameter variable">-P</span> 0x1436 <span class="token parameter variable">-M</span> <span class="token number">55534243123456780000000000000011062000000100000000000000000000</span></span></code></pre>

    </div><p>Afterwards, <code class="language-plain">lsusb</code> shows this:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-shell-session"><code class="language-shell-session"><span class="highlight-line"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">lsusb</span></span></span>
<span class="highlight-line"><span class="token output">Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub</span>
<span class="highlight-line">Bus 001 Device 003: ID 04f3:21d4 Elan Microelectronics Corp.</span>
<span class="highlight-line">Bus 001 Device 002: ID 8087:0a2b Intel Corp.</span>
<span class="highlight-line">Bus 001 Device 004: ID 0c45:6713 Microdia</span>
<span class="highlight-line">Bus 001 Device 006: ID 12d1:1436 Huawei Technologies Co., Ltd. Broadband stick</span>
<span class="highlight-line">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span></code></pre>

    </div><p>And <code class="language-plain">usb-devices</code> this:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-shell-session"><code class="language-shell-session"><span class="highlight-line"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">usb-devices</span></span></span>
<span class="highlight-line"><span class="token output">T:  Bus=01 Lev=01 Prnt=01 Port=00 Cnt=01 Dev#=  6 Spd=480 MxCh= 0</span>
<span class="highlight-line">D:  Ver= 2.00 Cls=ef(misc ) Sub=02 Prot=01 MxPS=64 #Cfgs=  1</span>
<span class="highlight-line">P:  Vendor=12d1 ProdID=1436 Rev=00.00</span>
<span class="highlight-line">S:  Manufacturer=HUAWEI Technology</span>
<span class="highlight-line">S:  Product=HUAWEI Mobile</span>
<span class="highlight-line">C:  #Ifs= 7 Cfg#= 1 Atr=e0 MxPwr=500mA</span>
<span class="highlight-line">I:  If#= 0 Alt= 0 #EPs= 3 Cls=ff(vend.) Sub=ff Prot=ff Driver=option</span>
<span class="highlight-line">I:  If#= 1 Alt= 0 #EPs= 1 Cls=02(commc) Sub=06 Prot=ff Driver=cdc_ether</span>
<span class="highlight-line">I:  If#= 2 Alt= 0 #EPs= 2 Cls=0a(data ) Sub=00 Prot=00 Driver=cdc_ether</span>
<span class="highlight-line">I:  If#= 3 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=option</span>
<span class="highlight-line">I:  If#= 4 Alt= 0 #EPs= 2 Cls=ff(vend.) Sub=ff Prot=ff Driver=option</span>
<span class="highlight-line">I:  If#= 5 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage</span>
<span class="highlight-line">I:  If#= 6 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage</span></code></pre>

    </div><p>I am then asked for my PIN again and the device is visible in mmcli and Modem Manager GUI.
Sometimes it takes a while to build up a connection but in the end it worked 10/10.</p>
<img src="/blog/2017-05-31-surfstick-huawei-e173-on-linux/huawei-e173-speedtest.jpg" width="640" height="390" alt="undefined">


<script async src="/scripts/index.js"></script>

    </div>
  </body>
</html>
