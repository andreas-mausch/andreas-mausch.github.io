
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Eleventy v3.0.0">
    <title>Vagrant alternative needed</title>
    <link rel="stylesheet" href="/styles/style.css"/>
    <link rel="stylesheet" href="/styles/icons/iconism.css"/>
    
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" sizes="any"/>
  </head>
  <body>
    <header class="site-header">
      <div class="site-header-content">
        <a class="site-title" href="/">Andreas Mausch</a>
        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              version="1.1"
              viewbox="0 0 16 16"
              width="100%"
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5">
              <path d="m2.75 12.25h10.5m-10.5-4h10.5m-10.5-4h10.5"/>
            </svg>
          </a>
          <input id="nav-toggle" type="checkbox"/>
          <label class="nav-button-container" for="nav-toggle">
            <div class="nav-button"></div>
          </label>
          <ol class="site-nav-items">
            <a class="page-link" href="/"><li class="page-link-home">Home</li></a><a class="page-link" href="/whatsapp-viewer/"><li>WhatsApp Viewer</li></a><a class="page-link" href="/blog/"><li>Blog</li></a></ol>
        </nav>
      </div>
    </header>
    <div class="content">
      
<h1>Vagrant alternative needed</h1>
<div>
  <time class="postlist-date" datetime="2025-01-24T18:00:00.000+00:00">Jan 24, 2025</time>
  <ul class="tags">
    
        
          <li><a href="/blog/tags/libvirt">#libvirt</a></li>
        
    
        
    
        
          <li><a href="/blog/tags/virtual%20machines">#virtual machines</a></li>
        
    
        
          <li><a href="/blog/tags/virtualbox">#virtualbox</a></li>
        
    
        
          <li><a href="/blog/tags/virtualization">#virtualization</a></li>
        
    
  </ul>
</div>



<h1 id="the-problem" tabindex="-1">1. The problem <a class="header-anchor" href="#the-problem" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>So few months ago I just wanted to start my virtual machine
by using my usual <code class="language-plain">vagrant</code> command, and I was greeted with this:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-shell-session"><code class="language-shell-session"><span class="highlight-line"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">vagrant up <span class="token parameter variable">--provider</span><span class="token operator">=</span>libvirt</span></span></span>
<span class="highlight-line"><span class="token output">/usr/lib/ruby/3.2.0/rubygems/specification.rb:2303:in `raise_if_conflicts': Unable to activate vagrant_cloud-3.1.1, because rexml-3.3.2 conflicts with rexml (~> 3.2.5) (Gem::ConflictError)</span>
<span class="highlight-line">        from /usr/lib/ruby/3.2.0/rubygems/specification.rb:1432:in `activate'</span>
<span class="highlight-line">        from /usr/lib/ruby/3.2.0/rubygems/core_ext/kernel_gem.rb:63:in `block in gem'</span>
<span class="highlight-line">        from /usr/lib/ruby/3.2.0/rubygems/core_ext/kernel_gem.rb:63:in `synchronize'</span>
<span class="highlight-line">        from /usr/lib/ruby/3.2.0/rubygems/core_ext/kernel_gem.rb:63:in `gem'</span>
<span class="highlight-line">        from /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/bin/vagrant:95:in `block (2 levels) in &lt;main>'</span>
<span class="highlight-line">        from /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/bin/vagrant:94:in `each'</span>
<span class="highlight-line">        from /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/bin/vagrant:94:in `block in &lt;main>'</span>
<span class="highlight-line">        from /opt/vagrant/embedded/gems/gems/vagrant-2.4.1/bin/vagrant:105:in `&lt;main>'</span>
<span class="highlight-line">$</span></code></pre>

    </div><p><a href="https://github.com/hashicorp/vagrant/issues/13502" class="external-link" target="_blank">https://github.com/hashicorp/vagrant/issues/13502</a><br>
Here they suggest to downgrade <code class="language-plain">ruby-rexml</code> to 3.2.6.
They don't talk about an actual fix until somebody explicitly asks for it,
getting 12 upvotes.</p>
<img src="/blog/2025-01-24-vagrant-alternatives/github-issue-13502-comment.png" width="932" height="157" alt="undefined">
<p><a href="https://github.com/hashicorp/vagrant/issues/13502#issuecomment-2371368299" class="external-link" target="_blank">https://github.com/hashicorp/vagrant/issues/13502#issuecomment-2371368299</a></p>
<p>It took over six weeks for <a href="https://github.com/hashicorp/vagrant_cloud/pull/87" class="external-link" target="_blank">this pull request</a>
to get merged.</p>
<img src="/blog/2025-01-24-vagrant-alternatives/github-vagrant-cloud-fixed.png" width="923" height="291" alt="undefined">
<p><a href="https://github.com/hashicorp/vagrant_cloud/pull/87#pullrequestreview-2414421181" class="external-link" target="_blank">https://github.com/hashicorp/vagrant_cloud/pull/87#pullrequestreview-2414421181</a></p>
<p>You can't be too mad at Chris when he apologizes so nicely,
but there were still six weeks in which I couldn't use my machine without hacks.
And it is not the first time for me Vagrant suddenly doesn't work anymore.</p>
<p>I think the reason here is the script-based projects with various dependencies.
I had trouble with multiple (mostly python) applications in the past.</p>
<p>That's why I'm looking for an alternative to Vagrant, which is statically linked.
A Rust project would be perfect.</p>
<p>There also is a second problem with Vagrant:
<a href="https://github.com/hashicorp/vagrant/issues/13501" class="external-link" target="_blank">Recent version of Virtualbox 7.1.0 is not supported</a>,
but I have to admit that could happen to a linked project as well.</p>
<p>Still:</p>
<img src="/blog/2025-01-24-vagrant-alternatives/github-issue-13501-still-no-support.png" width="938" height="151" alt="undefined">
<p><a href="https://github.com/hashicorp/vagrant/issues/13501#issuecomment-2425115546" class="external-link" target="_blank">https://github.com/hashicorp/vagrant/issues/13501#issuecomment-2425115546</a></p>
<img src="/blog/2025-01-24-vagrant-alternatives/github-issue-13501-completely-broken.png" width="935" height="214" alt="undefined">
<p><a href="https://github.com/hashicorp/vagrant/issues/13501#issuecomment-2561305736" class="external-link" target="_blank">https://github.com/hashicorp/vagrant/issues/13501#issuecomment-2561305736</a></p>
<h1 id="alternatives-to-vagrant" tabindex="-1">2. Alternatives to Vagrant <a class="header-anchor" href="#alternatives-to-vagrant" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>My requirements:</p>
<ul>
<li>I can start a virtual machine which is defined via a <code class="language-plain">.yaml</code> file in a single, simple command.</li>
<li>The yaml links to a base image, which can ideally run on libvirt and VirtualBox.</li>
<li>The yaml contains the hostname, usernames, ssh authenticated keys, enable sudo, maybe some network settings, dhcp, ntp etc.
(Sounds similar to what <code class="language-plain">cloud-init</code> does)</li>
<li>The yaml can contain additional scripts to be run on first boot</li>
</ul>
<p>To summarize: I wasn't able to find a good alternative for exactly that.
I will keep looking for one, though.</p>
<h2 id="lima" tabindex="-1">2.1. lima <a class="header-anchor" href="#lima" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<ul>
<li>written in Go</li>
<li>doesn't support <code class="language-plain">libvirt</code>, but works directly with <code class="language-plain">qemu</code>:
<a href="https://github.com/lima-vm/lima/issues/2031" class="external-link" target="_blank">https://github.com/lima-vm/lima/issues/2031</a></li>
<li>username cannot be changed:
<a href="https://github.com/lima-vm/lima/issues/1015" class="external-link" target="_blank">https://github.com/lima-vm/lima/issues/1015</a></li>
<li>has a very clean and easy to understand CLI</li>
<li>the machine can be defined as <code class="language-plain">.yaml</code></li>
</ul>
<p>So lima comes close to what I need, but without proper <code class="language-plain">libvirt</code>
support it is not a solution to me.</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line">limactl start</span>
<span class="highlight-line">limactl list</span>
<span class="highlight-line">limactl start my-box.yaml</span>
<span class="highlight-line">limactl shell my-box</span>
<span class="highlight-line">limactl disk list</span>
<span class="highlight-line">limactl stop my-box</span>
<span class="highlight-line">limactl remove my-box</span></code></pre>

    </div><div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-yaml"><code data-filename="./my-box.yaml" class="language-yaml"><span class="highlight-line"><span class="token key atrule">arch</span><span class="token punctuation">:</span> x86_64</span>
<span class="highlight-line"><span class="token key atrule">cpus</span><span class="token punctuation">:</span> <span class="token number">2</span></span>
<span class="highlight-line"><span class="token key atrule">memory</span><span class="token punctuation">:</span> 4GiB</span>
<span class="highlight-line"><span class="token key atrule">disk</span><span class="token punctuation">:</span> 20GiB</span>
<span class="highlight-line"><span class="token key atrule">images</span><span class="token punctuation">:</span></span>
<span class="highlight-line">  <span class="token punctuation">-</span> <span class="token key atrule">location</span><span class="token punctuation">:</span> <span class="token string">"https://cloud-images.ubuntu.com/releases/24.04/release-20240821/ubuntu-24.04-server-cloudimg-amd64.img"</span></span>
<span class="highlight-line">    <span class="token key atrule">arch</span><span class="token punctuation">:</span> <span class="token string">"x86_64"</span></span>
<span class="highlight-line">    <span class="token key atrule">digest</span><span class="token punctuation">:</span> <span class="token string">"sha256:0e25ca6ee9f08ec5d4f9910054b66ae7163c6152e81a3e67689d89bd6e4dfa69"</span></span></code></pre>

    </div><h2 id="multipass" tabindex="-1">2.2. multipass <a class="header-anchor" href="#multipass" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h2>
<p>I don't like it.</p>
<ul>
<li>written in C++</li>
<li>heavily focused on Ubuntu</li>
<li>requires a daemon</li>
<li>is from Canonical, is distributed via Snap Store :/</li>
<li>has support for <code class="language-plain">libvirt</code> (experimental) and VirtualBox via local &quot;drivers&quot;</li>
</ul>


<script async src="/scripts/index.js"></script>

    </div>
  </body>
</html>
