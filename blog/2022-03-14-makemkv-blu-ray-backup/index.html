
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Eleventy v3.0.0">
    <title>makemkv: Backup Blu-ray discs</title>
    <link rel="stylesheet" href="/styles/style.css"/>
    <link rel="stylesheet" href="/styles/icons/iconism.css"/>
    
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" sizes="any"/>
  </head>
  <body>
    <header class="site-header">
      <div class="site-header-content">
        <a class="site-title" href="/">Andreas Mausch</a>
        <nav class="site-nav">
          <a href="#" class="menu-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              version="1.1"
              viewbox="0 0 16 16"
              width="100%"
              fill="none"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="1.5">
              <path d="m2.75 12.25h10.5m-10.5-4h10.5m-10.5-4h10.5"/>
            </svg>
          </a>
          <input id="nav-toggle" type="checkbox"/>
          <label class="nav-button-container" for="nav-toggle">
            <div class="nav-button"></div>
          </label>
          <ol class="site-nav-items">
            <a class="page-link" href="/"><li class="page-link-home">Home</li></a><a class="page-link" href="/whatsapp-viewer/"><li>WhatsApp Viewer</li></a><a class="page-link" href="/blog/"><li>Blog</li></a></ol>
        </nav>
      </div>
    </header>
    <div class="content">
      
<h1>makemkv: Backup Blu-ray discs</h1>
<div>
  <time class="postlist-date" datetime="2022-03-14T18:00:00.000+00:00">Mar 14, 2022</time>
  <ul class="tags">
    
        
          <li><a href="/blog/tags/blu-ray">#blu-ray</a></li>
        
    
        
          <li><a href="/blog/tags/firmware%20flashing">#firmware flashing</a></li>
        
    
        
    
        
          <li><a href="/blog/tags/video">#video</a></li>
        
    
  </ul>
</div>



<p>I still like to use Blu-ray discs to watch movies.</p>
<p>Sometimes I want to watch them over the network though, and therefore I need to rip them from disc to put them on a hard-drive.</p>
<p>I stumbled across <a href="https://www.makemkv.com/" class="external-link" target="_blank">makemkv</a> and a Docker image <a href="https://github.com/jlesage/docker-makemkv" class="external-link" target="_blank">on github</a>.</p>
<p>Since I prefer CLI usage over GUI, I also looked up <a href="https://github.com/lasley/docker-makemkvcon" class="external-link" target="_blank">this Docker image</a>,
which provides only the CLI part named <code class="language-plain">makemkvcon</code>.</p>
<h1 id="installation" tabindex="-1">1. Installation <a class="header-anchor" href="#installation" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>First thing I noticed: I need a license key.
Luckily, <a href="https://forum.makemkv.com/forum/viewtopic.php?t=1053" class="external-link" target="_blank">it is freely available</a> while the software is still beta.</p>
<p>Next thing: I need to pass the device to the software.
For some reason, you need to pass two devices: <em>/dev/sr0</em> and <em>/dev/sg0</em> (on my machine, your numbers might be different).
And I had the <em>/dev/sr0</em>, but <em>/dev/sg0</em> was missing.</p>
<p>After some googling, I found that <code class="language-plain">sudo modprobe sg</code> solved it, and the device appeared.
To have the module loaded at every boot, you can also do this:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token builtin class-name">echo</span> sg <span class="token operator">></span> /etc/modules-load.d/sg.conf</span></code></pre>

    </div><h1 id="disable-auto-update%2C-settings.conf" tabindex="-1">2. Disable Auto-Update, settings.conf <a class="header-anchor" href="#disable-auto-update%2C-settings.conf" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>There is a file settings.conf with various settings, but barely documented.</p>
<p>The software greets me with this message:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-plain"><code class="language-plain"><span class="highlight-line">Automatic checking for updates is enabled, you may disable it in preferences if you don't want MakeMKV to contact web server.</span></code></pre>

    </div><p>..but I couldn't find a CLI flag to disable it.</p>
<p>I searched for a flag for the settings.conf to disable it, but didn't find it.</p>
<p>Eventually I used the GUI to disable the checkbox, and checked the settings.conf afterwards.
And voil√°, a key <code class="language-plain">app_UpdateEnable</code> was written in the file.</p>
<p>There was a <a href="(https://forum.makemkv.com/forum/viewtopic.php?t=8820)" class="external-link" target="_blank">request for documentation in the forum</a>, but it's an old thread
and the auto update wasn't mentioned there.
After knowing the key, I found <a href="https://forum.makemkv.com/forum/viewtopic.php?t=20364" class="external-link" target="_blank">this post</a>.</p>
<h1 id="my-drive" tabindex="-1">3. My drive <a class="header-anchor" href="#my-drive" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>I own a techPulse 120 drive.</p>
<p>makemkv told me the drive was detected as:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-plain"><code class="language-plain"><span class="highlight-line">HL-DT-ST_BD-RE_BU40N_1.02_211711301218_KZMIXXXXX51</span></code></pre>

    </div><p>which luckily is a very common model.</p>
<h1 id="rip-the-disc" tabindex="-1">4. Rip the disc <a class="header-anchor" href="#rip-the-disc" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>To just rip the whole disc, run this command:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">--rm</span> <span class="token parameter variable">-e</span> <span class="token string">"APP_KEY=&lt;secret key>"</span> <span class="token parameter variable">--device</span> /dev/sr0 <span class="token parameter variable">--device</span> /dev/sg0 <span class="token parameter variable">-v</span> <span class="token punctuation">(</span>pwd<span class="token punctuation">)</span>:/output lasley/makemkvcon:1.14.5 makemkvcon mkv disc:0 all /output</span></code></pre>

    </div><p>In general, I didn't find much documentation about the CLI commands.</p>
<p>I found <a href="https://gist.github.com/pjobson/b17a869f6a0a722521fd0f008ba45355" class="external-link" target="_blank">this great gist</a> and a lot of commands in the forum,
but it required some searching to find the commands I need.</p>
<h1 id="corrupt-or-invalid-at-offset" tabindex="-1">5. Corrupt or invalid at offset <a class="header-anchor" href="#corrupt-or-invalid-at-offset" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>I got presented a lot of errors, and I heard the drive slowed down a lot of times.
<a href="https://forum.makemkv.com/forum/viewtopic.php?t=7678" class="external-link" target="_blank">See this thread</a>.</p>
<p>The most named reason was a dirty disc or drive, so I cleaned both.
It didn't help.</p>
<h1 id="flashing-a-new-firmware" tabindex="-1">6. Flashing a new firmware <a class="header-anchor" href="#flashing-a-new-firmware" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>The next thing was an updated firmware. Not only does it unlock all region codes, but it also enables something called <em>LibreDrive</em>,
which (from what I understand) grants makemkv more direct access to the hardware.</p>
<p>Before flashing the firmware, I saw this log message:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-plain"><code class="language-plain"><span class="highlight-line">LibreDrive firmware support is not yet available for this drive (id=5B235XXXXFC2)</span></code></pre>

    </div><p>I was a bit scared to flash the firmware, because when I bought the model I remember there were like seven variations of the drive
(with/without 4K support, with/without M-Disc write support and some more).
So I feared to lose like the M-Disc support by flashing a wrong firmware variant.</p>
<p>Luckily it worked without major damage.</p>
<ul>
<li>Ultimate UHD Drives Flashing Guide Updated 2022: <a href="https://forum.makemkv.com/forum/viewtopic.php?f=16&amp;t=19634" class="external-link" target="_blank">https://forum.makemkv.com/forum/viewtopic.php?f=16&amp;t=19634</a></li>
<li>Custom firmware pack with LibreDrive patches: <a href="https://forum.makemkv.com/forum/viewtopic.php?t=19113" class="external-link" target="_blank">https://forum.makemkv.com/forum/viewtopic.php?t=19113</a></li>
<li>SDFtool Flasher: <a href="https://forum.makemkv.com/forum/viewtopic.php?t=22896" class="external-link" target="_blank">https://forum.makemkv.com/forum/viewtopic.php?t=22896</a></li>
<li>sdf.bin: <a href="https://makemkv.com/sdf.bin" class="external-link" target="_blank">https://makemkv.com/sdf.bin</a></li>
</ul>
<p>The commands I ran were:</p>
<div class="code-block">
    <button type="button" class="copy-to-clipboard">
      <i class="icon icon-copy"></i>
    </button>
    <pre class="language-shell-session"><code class="language-shell-session"><span class="highlight-line"><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">./makemkvcon f <span class="token parameter variable">-l</span></span></span></span>
<span class="highlight-line"><span class="token output">Found 1 drives(s)</span>
<span class="highlight-line">00: dev_21:0, /dev/sr0, /dev/sr0</span>
<span class="highlight-line">  HL-DT-ST_BD-RE_BU40N_1.02_211711301218_KZMIXXXXX51</span>
<span class="highlight-line"></span>
<span class="highlight-line"></span><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash">./makemkvcon f <span class="token parameter variable">-v</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-d</span> /dev/sr0 <span class="token parameter variable">-f</span> ./sdf.bin rawflash main <span class="token parameter variable">-i</span> ./HL-DT-ST-BD-RE_BU40N-1.03-NM00000-211810241934.bin</span></span></span></code></pre>

    </div><p>And it worked! On the next connection, my drive was detected with the updated firmware.</p>
<h1 id="docker%2C-virtualbox" tabindex="-1">7. Docker, VirtualBox <a class="header-anchor" href="#docker%2C-virtualbox" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>However, the flashed firmware didn't solve the problem of the corrupt sectors.
So I tried a Windows VM in VirtualBox, passed the USB connection over and tried there.
First it looked and sounded a bit better, but after some time the same errors occured.</p>
<h1 id="windows...and-success!" tabindex="-1">8. Windows...and success! <a class="header-anchor" href="#windows...and-success!" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a></h1>
<p>So my last resort was to use another PC. This time my gaming PC, with a Windows running directly
without virtualization.</p>
<p>And what can I say...first try and the backup worked immediately.</p>
<p>I'm not sure what the problem was. :( I could only guess.
But I'm happy it works now.</p>


<script async src="/scripts/index.js"></script>

    </div>
  </body>
</html>
